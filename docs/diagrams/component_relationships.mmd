graph TD
    subgraph "Core Components"
        Fetcher[Fetcher]
        Context[FetchContext]
        Plan[FetchPlan]
    end

    subgraph "Bundle Locator Layer"
        Provider1[SFTP Directory<br/>Bundle Locator]
        Provider2[SFTP File<br/>Bundle Locator]
        Provider3[HTTP URL<br/>Bundle Locator]
    end

    subgraph "Protocol Layer"
        HttpManager[HTTP Manager]
        SftpManager[SFTP Manager]
    end

    subgraph "Bundle Loader Layer"
        HttpLoader[HTTP Streaming<br/>Loader]
        SftpLoader[SFTP<br/>Loader]
    end

    subgraph "Storage Layer"
        FileStorage[File Storage]
        S3Storage[S3 Storage]
        Decorators[Storage Decorators]
    end

    subgraph "Supporting Systems"
        KVStore[Key-Value Store]
        Logger[Structured Logger]
        Config[Global Config]
    end

    %% Core relationships
    Fetcher --> Context
    Fetcher --> Plan
    Context --> Provider1
    Context --> Provider2
    Context --> Provider3
    Context --> HttpLoader
    Context --> SftpLoader
    Context --> FileStorage
    Context --> S3Storage

    %% Protocol relationships
    HttpLoader --> HttpManager
    SftpLoader --> SftpManager

    %% Storage relationships
    FileStorage --> Decorators
    S3Storage --> Decorators

    %% Supporting relationships
    Fetcher --> KVStore
    Fetcher --> Logger
    Fetcher --> Config

    style Fetcher fill:#e1f5fe
    style Context fill:#e1f5fe
    style Plan fill:#e1f5fe
